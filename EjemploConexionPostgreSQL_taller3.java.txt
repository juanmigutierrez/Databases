package test_db;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;


public class EjemploConexionPostgreSQL_taller3 {
    public static void main(String[] args) {
    	
    	//Intenta establecer conexión
    	System.out.println("Estableciendo conexión...");
        try (Connection conexion = DriverManager.getConnection("jdbc:postgresql://localhost:5432/taller3", "postgres", "postgres")) {
 
            
            System.out.println("Conexion con la base de datos establecida (PostgreSQL)");
            Statement statement = conexion.createStatement();
            
            
            
          //Ejemplo inserción
           // System.out.println("Consultando la base de datos...");
            //statement.executeUpdate("insert into curso values ('005', 'probabilidad', 'MACC', 3);");
            
          //Ejemplo consulta
            System.out.println("Consultando la base de datos...");
            ResultSet resultSet = statement.executeQuery("select nombre, nombre_unid, creditos from public.curso where nombre_unid = 'MACC';");
            
            System.out.println("Imprimiendo resultados...");
            System.out.printf("%-30.30s  %-30.30s %-30.30s%n", "Nombre", "Unidad", "# créditos");
            int totCreditos = 0;
            while (resultSet.next()) {
                System.out.printf("%-30.30s  %-30.30s  %-30.30s%n", resultSet.getString("nombre"), resultSet.getString("nombre_unid"), resultSet.getString("creditos"));
                totCreditos += Integer.parseInt(resultSet.getString("creditos"));
            }
            System.out.printf("# créditos totales: %d%n", totCreditos);
            
            
        } catch (SQLException e) {
            System.out.println("Conexión fallida");
            e.printStackTrace();
        }
    }

}



 
